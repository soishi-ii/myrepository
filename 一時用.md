Microsoft Sentinelでは、「分析ルール（Analytics Rules）」を使ってさまざまなセキュリティイベントの検知・アラート化が可能です。以下に **主なルールの種類（テンプレートカテゴリ）** と **設定できるルールの一覧例** をカテゴリ別に紹介します。

---

## ■ Microsoft Sentinel で設定できる主なルール種別一覧

### 1. **Scheduled Rules（スケジュールルール）**

> 指定したKQLクエリを一定間隔で実行し、条件に一致するイベントをアラートに変換する。

- 例：
    - 多数のログイン失敗イベント（ブルートフォース攻撃）
    - 退職者アカウントからのログイン試行
    - 多要素認証（MFA）失敗の急増
    - 不審なPowerShellの実行ログ
    - Sentinelに取り込まれたログに基づく独自ルール

### 2. **Microsoft Security (Fusion) Rules**

> 複数のMicrosoftセキュリティサービス（Defender、MCAS、AADなど）のシグナルを関連付けて脅威を検知。

- 例（Fusionのテンプレート）：
    - 多段階攻撃の可能性（認証→データ漏洩）
    - マルウェア感染→横移動→重要ファイルアクセスの組み合わせ
    - 異常なクラウドアプリ利用＋ファイル転送

### 3. **ML Behavioral Analytics（機械学習ルール）**

> Sentinelが自動的にユーザー/エンティティの行動ベースラインを学習し、異常行動を検知。

- 例：
    - 異常な時間帯やIPアドレスからのログイン
    - 通常とは異なるアプリやデバイス使用
    - 急激なデータダウンロード増加

### 4. **Microsoft Defender 連携ルール**

> Defender製品（Endpoint、Cloud Apps、Identityなど）からのアラートをトリガーにする。

- 例：
    - Defender for Endpoint の高危険度アラート発生
    - Defender for Identity によるパスワードスプレー攻撃検知
    - Defender for Cloud での重大な脆弱性検出

### 5. **Threat Intelligence ルール**

> Threat Intelligence（TI）データとログを突き合わせて脅威を検出。

- 例：
    - TIに含まれる悪性IPからのトラフィック検出
    - マルウェアに関連するドメインへの通信
    - ブラックリスト入りのメール送信元の検出

### 6. **Custom Rules（カスタムルール）**

> 独自のKQL（Kusto Query Language）を使って完全に自由に条件設定可能。

---

## ■ Sentinel ルールテンプレートの具体例（一部）

|カテゴリ|ルール例|
|---|---|
|Azure AD|多数のログイン失敗、初回サインインが異常な国から|
|Office 365|大量のメール削除、外部へのメール転送設定の追加|
|Defender for Endpoint|ランサムウェアの兆候、異常なプロセスの連鎖|
|MCAS（Cloud Apps）|不審なファイル共有、大量ダウンロード|
|Identity Protection|リスクの高いユーザーログイン|
|Kubernetes|非認証ユーザーによる管理操作|
|AWS/Azure/GCP|不審なIAM操作、S3の公開設定変更|
|GitHub/DevOps|不正なリポジトリ変更、PATトークンの不審使用|

---

## ■ カスタマイズ可能な要素

|要素|説明|
|---|---|
|実行間隔|5分～24時間など自由に設定可能|
|アラートのしきい値|一定回数以上検出でアラート発火など|
|エンリッチ情報|IPの位置情報、ユーザーの所属など|
|自動応答（Playbook）|アラート発生時にメール通知やTeams連携など|

---

必要であれば、**具体的なKQLルール例**や**おすすめのテンプレート**もご紹介できます。興味のあるカテゴリがあれば教えてください。